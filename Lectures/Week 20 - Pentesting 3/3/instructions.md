# Pentesting Project: Attack Strategy

### Lesson Lab Environment

To complete this homework assignment, you will need to download and install the following VMs:

- [Kali](https://images.offensive-security.com/virtual-images/kali-linux-2019.4-vbox-amd64.ova)

- [The vulnerable webserver](https://drive.google.com/open?id=1Eq_SY5focVH2tlxTtiRsMIU04wlRX7mu)

Please use the default credentials for the Kali machine (Username: `root` Password: `toor`).

## Debriefing


### Scenario

Your firm recently landed a contract to assess the security of their internal network. The most important machine on this network is their web server, which hosts their public-facing website. This machine also exposes an SSH server, which administrators can use to add, remove, or edit files on the website.

Since this machine is so important to their core business, they do not want you to test the live production server. Instead, you’ve been provided a virtual machine image. The clients requested that you attach this VM to your local network and perform a preliminary assessment. This precaution ensures that nothing you do while testing will take the site offline or deface the public-facing website.


### Your Tools

Therefore, you are allowed to attack it using any tools, technologies, and procedures (TTPs) that you see fit. Since you don’t have to worry about accidentally taking down the site, you are free to use brute-force and other high-bandwidth tactics.

#### Your Objective

You will be expected to find **four hidden flags**. These flags are placeholders for highly sensitive data that lives on the production server. If you find them, you have essentially compromised the firm’s security. You can find two on the website and two on the server’s file system. The firm provided no additional clues.

In addition to the locations of the flags, you are expected to create a final report summarizing the vulnerabilities you found; how you exploited them; and which patches you’d recommend.

---

## Playbook

You’re free to attack the site however you like. But you may also refer to the methodology below for a consistent approach.

### Host and Service Enumeration

After launching the VM, use Nmap to scan your local subnet. Identify the target’s IP address, and then use Nmap to perform service, version,and OS discovery.

Be sure to use stealth options and test for open UDP ports.

`netdiscover` is another tool you can research for host discovery.

### Web Enumeration

Your service scan should reveal an HTTP server. Use the following steps to explore and analyze the site:
- Use Burp Suite to generate a site map by manually browsing the site.
- Use Burp Spider to expand your site map.
- Use `wfuzz` to perform URL enumeration. Use one of the default wordlists provided in the `wfuzz` directory.
- Use `wpscan` to break through the WordPress blog’s login form.

You will find two flags on the website. One is embedded in HTML somewhere on the site, the other is hidden in the WordPress administration panel. You will have to break in to it in order to find it.

### Network Exploitation and Post-Exploitation Pillaging

Your Nmap scan should identify an SSH server. Use a tool like `hydra` or `patator` to brute-force the login.

This should land you a user shell. Determine which accounts have `sudo` permissions, then find out which commands they’re allowed to run. When you discover which account is able to run Python as root, figure out how to use the snippet below to get a root shell on the victim machine:

```
sudo python -c “import pty; pty.spawn(‘/bin/bash’)”
```

From here, take a screenshot of your user ID to prove that you’re root. Then, use find or other tools to locate the flags on the server’s file system.

---

## Reporting

After all is done and dusted, you’ll need to put together a report for your clients.

Use the team’s shared report template, [available here](https://docs.google.com/document/d/1sTqbm1h4kgfThZcywgZBj9vS7OC5HaoKg3q5RXVEEps/edit?usp=sharing).
